// Generated by CoffeeScript 1.6.2
define(function(require) {
  var DropoxStore, Project;

  Project = require("core/projects/project");
  DropoxStore = require('stores/dropbox/dropBoxStore2');
  return describe("dropboxStore", function() {
    var dropboxStore, project;

    project = null;
    dropboxStore = null;
    beforeEach(function() {
      project = new Project({
        name: "TestProject"
      });
      project.addFile({
        name: "TestProject.coffee",
        content: "bla bla"
      });
      dropboxStore = new BrowserStore({
        rootUri: "projectsTest"
      });
      return dropboxStore.setup();
    });
    it('can save projects', function() {
      var expLocalStorageData, obsLocalStorageData;

      dropboxStore.saveProject(project);
      obsLocalStorageData = localStorage.getItem("projectsTest/TestProject/TestProject.coffee");
      expLocalStorageData = "{\"name\":\"TestProject.coffee\",\"content\":\"bla bla\",\"isActive\":false,\"isSaveAdvised\":false,\"isCompileAdvised\":false}";
      expect(obsLocalStorageData).toEqual(expLocalStorageData);
      return localStorage.removeItem("projectsTest/TestProject/TestProject.coffee");
    });
    it('can load projects', function() {
      var fileData;

      fileData = "{\"name\":\"TestProject.coffee\",\"content\":\"bla bla\",\"isActive\":false,\"isSaveAdvised\":false,\"isCompileAdvised\":false}";
      localStorage.setItem("projectsTest/TestProject/TestProject.coffee", fileData);
      localStorage.setItem("projectsTest/TestProject", ["TestProject.coffee", "SomeOtherFile.coffee"]);
      project = dropboxStore.loadProject("TestProject");
      localStorage.removeItem("projectsTest/TestProject");
      return localStorage.removeItem("projectsTest/TestProject/TestProject.coffee");
    });
    it('can list projects', function() {
      var expProjectsList, obsProjectsList;

      dropboxStore.saveProject(project);
      obsProjectsList = dropboxStore.listProjects();
      expProjectsList = ["TestProject"];
      return expect(obsProjectsList).toEqual(expProjectsList);
    });
    it('can list a project s files', function() {
      var expProjectsList, obsProjectsList;

      dropboxStore.saveProject(project);
      obsProjectsList = dropboxStore.listProjectFiles();
      expProjectsList = ["TestProject"];
      return expect(obsProjectsList).toEqual(expProjectsList);
    });
    it('can rename projects', function() {
      return dropboxStore.renameProject(project, "FooProject");
    });
    it('can delete projects by name', function() {
      var expStorageData, obsStorageData;

      dropboxStore.saveProject(project);
      dropboxStore.deleteProject("TestProject");
      expStorageData = null;
      obsStorageData = localStorage.getItem("projectsTest" + "TestProject");
      expect(obsStorageData).toEqual(expStorageData);
      expStorageData = null;
      obsStorageData = localStorage.getItem("projectsTest/TestProject/TestProject.coffee");
      return expect(obsStorageData).toEqual(expStorageData);
    });
    return it("provides a shorthand to get a project's thumbnail", function() {
      var expThumbnail, obsthumbnail;

      project.addFile({
        name: ".thumbnail.png",
        content: "beautifull image"
      });
      dropboxStore.saveProject(project);
      obsthumbnail = dropboxStore.getThumbNail("TestProject");
      expThumbnail = "beautifull image";
      return expect(obsthumbnail).toEqual(expThumbnail);
    });
  });
});
